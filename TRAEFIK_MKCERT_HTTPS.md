# Using Traefik and mkcert for HTTPS Access

This document describes how to configure HTTPS access for the Atlassian DC MCP service using Traefik and mkcert.

## Overview

[mkcert](https://github.com/FiloSottile/mkcert) is a simple tool for local HTTPS development that can create locally trusted development certificates. Combined with Traefik reverse proxy, we can provide HTTPS access for the MCP service.

## Prerequisites

1. Install Docker and Docker Compose
2. Install the mkcert tool

## Installing mkcert

### macOS (using Homebrew)

```bash
brew install mkcert
brew install nss # if using Firefox browser
```

### Linux

On Linux, you need to install the mkcert binary:

```bash
# Download the latest version of mkcert
wget https://github.com/FiloSottile/mkcert/releases/download/v1.4.4/mkcert-v1.4.4-linux-amd64
chmod +x mkcert-v1.4.4-linux-amd64
sudo mv mkcert-v1.4.4-linux-amd64 /usr/local/bin/mkcert
```

## Create Local CA and Generate Certificates

1. Install the local CA:

```bash
mkcert -install
```

This will install the local CA in the system, making all certificates generated by mkcert trusted.

2. Create the certs folder in the project directory:

```bash
mkdir -p ./certs
cd ./certs
```

3. Generate local development certificates:

```bash
mkcert localhost 127.0.0.1 ::1
```

This will generate two files:
- `localhost+2.pem` (certificate file)
- `localhost+2-key.pem` (private key file)

## Configuring Traefik

The project includes Traefik configuration files in the [traefik-config/](traefik-config/) directory:

1. [traefik-config/traefik.yml](traefik-config/traefik.yml) - Main Traefik configuration
2. [traefik-config/certs.yml](traefik-config/certs.yml) - Certificate configuration

Traefik is configured to:
- Listen on port 443 for HTTPS requests
- Use the mkcert certificates
- Handle both regular HTTP requests and SSE streams
- Communicate with the MCP server using HTTP/2

## Starting the Service

Use the following commands to start the service with Traefik:

```bash
# Build and start the service
docker-compose -f docker-compose.traefik.yml up -d

# View logs
docker-compose -f docker-compose.traefik.yml logs -f
```

## Verifying the Configuration

After starting the service, you can access the MCP service through the following URLs:

- HTTPS: https://localhost/sse
- Traefik Dashboard: http://localhost:8080 (accessible only from the host machine)

## Configuring AI Assistant

When configuring the MCP service in your AI assistant, use the following configuration:

```json
{
  "mcpServers": {
    "atlassian-dc-mcp-sse": {
      "url": "https://localhost/sse",
      "headers": {
        "Jira-Token": "your-jira-api-token",
        "Confluence-Token": "your-confluence-api-token",
        "Bitbucket-Token": "your-bitbucket-api-token"
      }
    }
  }
}
```